YUI.add("moodle-availability_enroldate-form",(function(e,a){M.availability_enroldate=M.availability_enroldate||{},M.availability_enroldate.form=e.Object(M.core_availability.plugin),M.availability_enroldate.form.initInner=function(e,a){this.html=e,this.defaultTime=a},M.availability_enroldate.form.getNode=function(a){var t='<span class="col-form-label p-r-1">'+M.util.get_string("direction_before","availability_enroldate")+'</span> <span class="availability-group"><label><span class="accesshide">'+M.util.get_string("direction_label","availability_enroldate")+' </span><select name="direction" class="custom-select"><option value="&gt;=">'+M.util.get_string("enroldate_after","availability_enroldate")+'</option><option value="&lt;">'+M.util.get_string("enroldate_before","availability_enroldate")+"</option></select></label></span> "+this.html,i=e.Node.create("<span>"+t+"</span>");if(void 0!==a.t){i.setData("time",a.t),i.all("select:not([name=direction])").each((function(e){e.set("disabled",!0)}));var l=M.cfg.wwwroot+"/availability/condition/enroldate/ajax.php?action=fromtime&time="+a.t;e.io(l,{on:{success:function(a,t){var l=e.JSON.parse(t.responseText);for(var n in l){var o=i.one("select[name=x\\["+n+"\\]]");o.set("value",""+l[n]),o.set("disabled",!1)}},failure:function(){window.alert(M.util.get_string("ajaxerror","availability_enroldate"))}}})}else i.setData("time",this.defaultTime);if(void 0!==a.d&&i.one("select[name=direction]").set("value",a.d),!M.availability_enroldate.form.addedEvents){M.availability_enroldate.form.addedEvents=!0;var n=e.one(".availability-field");n.delegate("change",(function(){M.core_availability.form.update()}),".availability_enroldate select[name=direction]"),n.delegate("change",(function(){M.availability_enroldate.form.updateTime(this.ancestor("span.availability_enroldate"))}),".availability_enroldate select:not([name=direction])")}if(i.one("a[href=#]")){M.form.dateselector.init_single_date_selector(i);var o=i.one("select[name=x\\[year\\]]"),r=o.set;o.set=function(e,a){r.call(o,e,a),"selectedIndex"===e&&setTimeout((function(){M.availability_enroldate.form.updateTime(i)}),0)}}return i},M.availability_enroldate.form.updateTime=function(a){var t=M.cfg.wwwroot+"/availability/condition/enroldate/ajax.php?action=totime&year="+a.one("select[name=x\\[year\\]]").get("value")+"&month="+a.one("select[name=x\\[month\\]]").get("value")+"&day="+a.one("select[name=x\\[day\\]]").get("value")+"&hour="+a.one("select[name=x\\[hour\\]]").get("value")+"&minute="+a.one("select[name=x\\[minute\\]]").get("value");e.io(t,{on:{success:function(e,t){a.setData("time",t.responseText),M.core_availability.form.update()},failure:function(){window.alert(M.util.get_string("ajaxerror","availability_enroldate"))}}})},M.availability_enroldate.form.fillValue=function(e,a){e.d=a.one("select[name=direction]").get("value"),e.t=parseInt(a.getData("time"),10)}}),"@VERSION@",{requires:["base","node","event","moodle-core_availability-form"]});
